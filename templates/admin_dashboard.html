<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Super Admin Dashboard - Enterprise Support System</title>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        :root {
            --primary-color: #dc3545;
            --secondary-color: #6c757d;
            --success-color: #28a745;
            --info-color: #17a2b8;
            --warning-color: #ffc107;
            --danger-color: #dc3545;
            --light-color: #f8f9fa;
            --dark-color: #343a40;
            --sidebar-width: 280px;
            --header-height: 70px;
            --border-radius: 12px;
            --shadow: 0 4px 20px rgba(0,0,0,0.1);
            --transition: all 0.3s ease;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: var(--light-color);
            color: var(--dark-color);
            overflow-x: hidden;
        }

        /* Header */
        .header {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            height: var(--header-height);
            background: linear-gradient(135deg, var(--primary-color), #c82333);
            color: white;
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 0 20px;
            box-shadow: var(--shadow);
            z-index: 1000;
        }

        .header-left {
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .header-title {
            font-size: 1.5rem;
            font-weight: 700;
        }

        .header-subtitle {
            font-size: 0.9rem;
            opacity: 0.8;
        }

        .header-right {
            display: flex;
            align-items: center;
            gap: 20px;
        }

        .user-info {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .user-avatar {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: rgba(255,255,255,0.2);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.2rem;
        }

        .logout-btn {
            background: rgba(255,255,255,0.2);
            color: white;
            border: none;
            padding: 8px 16px;
            border-radius: 6px;
            cursor: pointer;
            transition: var(--transition);
            font-weight: 600;
        }

        .logout-btn:hover {
            background: rgba(255,255,255,0.3);
            transform: translateY(-2px);
        }

        /* Sidebar */
        .sidebar {
            position: fixed;
            top: var(--header-height);
            left: 0;
            width: var(--sidebar-width);
            height: calc(100vh - var(--header-height));
            background: white;
            border-right: 1px solid #e9ecef;
            overflow-y: auto;
            z-index: 999;
            transition: var(--transition);
        }

        .sidebar-header {
            padding: 20px;
            border-bottom: 1px solid #e9ecef;
            background: var(--light-color);
        }

        .sidebar-title {
            font-size: 1.1rem;
            font-weight: 600;
            color: var(--dark-color);
        }

        .nav-menu {
            padding: 20px 0;
        }

        .nav-item {
            margin-bottom: 5px;
        }

        .nav-link {
            display: flex;
            align-items: center;
            gap: 12px;
            padding: 15px 20px;
            color: #666;
            text-decoration: none;
            transition: var(--transition);
            border-left: 3px solid transparent;
        }

        .nav-link:hover,
        .nav-link.active {
            background: var(--light-color);
            color: var(--primary-color);
            border-left-color: var(--primary-color);
        }

        .nav-link i {
            width: 20px;
            text-align: center;
        }

        /* Main Content */
        .main-content {
            margin-left: var(--sidebar-width);
            margin-top: var(--header-height);
            padding: 30px;
            min-height: calc(100vh - var(--header-height));
            transition: var(--transition);
        }

        .tab-content {
            display: none;
        }

        .tab-content.active {
            display: block;
            animation: fadeIn 0.3s ease-in;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .page-header {
            margin-bottom: 30px;
        }

        .page-title {
            font-size: 2rem;
            font-weight: 700;
            color: var(--dark-color);
            margin-bottom: 10px;
        }

        .page-subtitle {
            color: #666;
            font-size: 1.1rem;
        }

        /* Dashboard Overview */
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 25px;
            margin-bottom: 40px;
        }

        .stat-card {
            background: white;
            border-radius: var(--border-radius);
            padding: 25px;
            box-shadow: var(--shadow);
            border: 1px solid #e9ecef;
            transition: var(--transition);
        }

        .stat-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 30px rgba(0,0,0,0.15);
        }

        .stat-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 20px;
        }

        .stat-icon {
            width: 60px;
            height: 60px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.8rem;
            color: white;
        }

        .stat-icon.primary { background: var(--primary-color); }
        .stat-icon.success { background: var(--success-color); }
        .stat-icon.info { background: var(--info-color); }
        .stat-icon.warning { background: var(--warning-color); }

        .stat-number {
            font-size: 2.5rem;
            font-weight: 700;
            color: var(--dark-color);
            margin-bottom: 5px;
        }

        .stat-label {
            color: #666;
            font-size: 0.9rem;
            font-weight: 600;
        }

        .stat-change {
            display: flex;
            align-items: center;
            gap: 5px;
            font-size: 0.9rem;
            margin-top: 10px;
        }

        .stat-change.positive { color: var(--success-color); }
        .stat-change.negative { color: var(--danger-color); }

        /* Charts Section */
        .charts-section {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 25px;
            margin-bottom: 40px;
        }

        /* User Management */
        .user-management {
            background: white;
            border-radius: var(--border-radius);
            padding: 25px;
            box-shadow: var(--shadow);
        }

        .section-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 25px;
            padding-bottom: 15px;
            border-bottom: 2px solid #e9ecef;
        }

        .section-title {
            font-size: 1.5rem;
            font-weight: 600;
            color: var(--dark-color);
        }

        .add-user-btn {
            background: var(--success-color);
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 600;
            transition: var(--transition);
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .add-user-btn:hover {
            background: #218838;
            transform: translateY(-2px);
        }

        .user-form {
            background: var(--light-color);
            padding: 25px;
            border-radius: 10px;
            margin-bottom: 25px;
            display: none;
        }

        .user-form.show {
            display: block;
            animation: slideDown 0.3s ease-out;
        }

        @keyframes slideDown {
            from { opacity: 0; max-height: 0; }
            to { opacity: 1; max-height: 500px; }
        }

        .form-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 20px;
        }

        .form-group {
            display: flex;
            flex-direction: column;
        }

        .form-group label {
            margin-bottom: 8px;
            font-weight: 600;
            color: var(--dark-color);
        }

        .form-group input,
        .form-group select {
            padding: 12px 15px;
            border: 2px solid #e9ecef;
            border-radius: 8px;
            font-size: 14px;
            transition: var(--transition);
        }

        .form-group input:focus,
        .form-group select:focus {
            outline: none;
            border-color: var(--primary-color);
            box-shadow: 0 0 0 3px rgba(220, 53, 69, 0.1);
        }

        .form-actions {
            display: flex;
            gap: 15px;
            justify-content: flex-end;
        }

        .btn {
            padding: 10px 20px;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-weight: 600;
            transition: var(--transition);
        }

        .btn-primary { background: var(--primary-color); color: white; }
        .btn-secondary { background: var(--secondary-color); color: white; }
        .btn-success { background: var(--success-color); color: white; }
        .btn-danger { background: var(--danger-color); color: white; }

        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 15px rgba(0,0,0,0.2);
        }

        /* Users Table */
        .users-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 20px;
        }

        .users-table th,
        .users-table td {
            padding: 15px;
            text-align: left;
            border-bottom: 1px solid #e9ecef;
        }

        .users-table th {
            background: var(--light-color);
            font-weight: 600;
            color: var(--dark-color);
            position: sticky;
            top: 0;
        }

        .users-table tr:hover {
            background: var(--light-color);
        }

        .status-badge {
            padding: 6px 12px;
            border-radius: 20px;
            font-size: 0.8rem;
            font-weight: 600;
            text-transform: uppercase;
        }

        .status-active {
            background: #d4edda;
            color: #155724;
        }

        .status-inactive {
            background: #f8d7da;
            color: #721c24;
        }

        .role-badge {
            padding: 6px 12px;
            border-radius: 20px;
            font-size: 0.8rem;
            font-weight: 600;
        }

        .role-admin {
            background: #fff3cd;
            color: #856404;
        }

        .role-agent {
            background: #d1ecf1;
            color: #0c5460;
        }

        /* Performance Reports */
        .performance-section {
            background: white;
            border-radius: var(--border-radius);
            padding: 25px;
            box-shadow: var(--shadow);
        }

        .report-controls {
            display: flex;
            gap: 15px;
            align-items: center;
        }

        .report-controls select {
            padding: 8px 12px;
            border: 2px solid #e9ecef;
            border-radius: 6px;
            font-size: 14px;
            background: white;
        }

        .performance-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .performance-card {
            background: var(--light-color);
            border-radius: 10px;
            padding: 20px;
            display: flex;
            align-items: center;
            gap: 15px;
            border: 1px solid #e9ecef;
            transition: var(--transition);
        }

        .performance-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
        }

        .performance-icon {
            width: 50px;
            height: 50px;
            border-radius: 50%;
            background: var(--primary-color);
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 1.2rem;
        }

        .performance-content {
            flex: 1;
        }

        .performance-number {
            font-size: 1.8rem;
            font-weight: 700;
            color: var(--dark-color);
            margin-bottom: 5px;
        }

        .performance-label {
            color: #666;
            font-size: 0.9rem;
            margin-bottom: 8px;
        }

        .performance-trend {
            font-size: 0.8rem;
            font-weight: 600;
        }

        .performance-trend.positive {
            color: var(--success-color);
        }

        .performance-trend.negative {
            color: var(--danger-color);
        }

        .performance-charts {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 25px;
        }

        .chart-legend {
            display: flex;
            gap: 20px;
        }

        .legend-item {
            display: flex;
            align-items: center;
            gap: 8px;
            font-size: 0.9rem;
            color: #666;
        }

        .legend-color {
            width: 12px;
            height: 12px;
            border-radius: 50%;
        }

        .legend-color.ai {
            background: var(--primary-color);
        }

        .legend-color.human {
            background: var(--success-color);
        }

        /* System Settings */
        .settings-section {
            background: white;
            border-radius: var(--border-radius);
            padding: 25px;
            box-shadow: var(--shadow);
        }

        .settings-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(400px, 1fr));
            gap: 25px;
            margin-bottom: 30px;
        }

        .settings-card {
            background: var(--light-color);
            border-radius: 12px;
            padding: 20px;
            border: 1px solid #e9ecef;
            transition: var(--transition);
        }

        .settings-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
        }

        .settings-card-header {
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 1px solid #e9ecef;
        }

        .settings-card-header h3 {
            color: var(--dark-color);
            font-size: 1.2rem;
            font-weight: 600;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .settings-card-header i {
            color: var(--primary-color);
        }

        .settings-form .form-group {
            margin-bottom: 20px;
        }

        .settings-form .form-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: var(--dark-color);
        }

        .settings-form .form-group input,
        .settings-form .form-group select {
            width: 100%;
            padding: 10px 12px;
            border: 2px solid #e9ecef;
            border-radius: 6px;
            font-size: 14px;
            transition: var(--transition);
        }

        .settings-form .form-group input:focus,
        .settings-form .form-group select:focus {
            outline: none;
            border-color: var(--primary-color);
            box-shadow: 0 0 0 3px rgba(220, 53, 69, 0.1);
        }

        .settings-form .form-group small {
            display: block;
            margin-top: 5px;
            color: #666;
            font-size: 0.8rem;
        }

        /* Toggle Switch */
        .toggle-switch {
            position: relative;
            display: inline-block;
            width: 50px;
            height: 24px;
        }

        .toggle-switch input {
            opacity: 0;
            width: 0;
            height: 0;
        }

        .toggle-switch label {
            position: absolute;
            cursor: pointer;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: #ccc;
            transition: var(--transition);
            border-radius: 24px;
        }

        .toggle-switch label:before {
            position: absolute;
            content: "";
            height: 18px;
            width: 18px;
            left: 3px;
            bottom: 3px;
            background-color: white;
            transition: var(--transition);
            border-radius: 50%;
        }

        .toggle-switch input:checked + label {
            background-color: var(--success-color);
        }

        .toggle-switch input:checked + label:before {
            transform: translateX(26px);
        }

        /* System Status */
        .system-status-section {
            background: var(--light-color);
            border-radius: 12px;
            padding: 20px;
            border: 1px solid #e9ecef;
        }

        .status-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }

        .status-item {
            display: flex;
            align-items: center;
            gap: 15px;
            padding: 15px;
            background: white;
            border-radius: 8px;
            border: 1px solid #e9ecef;
        }

        .status-icon {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 1.1rem;
        }

        .status-icon.online {
            background: var(--success-color);
        }

        .status-icon.offline {
            background: var(--danger-color);
        }

        .status-icon.warning {
            background: var(--warning-color);
        }

        .status-info {
            flex: 1;
        }

        .status-label {
            font-weight: 600;
            color: var(--dark-color);
            margin-bottom: 2px;
        }

        .status-value {
            color: #666;
            font-size: 0.9rem;
        }

        /* Notifications */
        .notification {
            position: fixed;
            top: 20px;
            right: 20px;
            padding: 15px 20px;
            border-radius: 8px;
            color: white;
            font-weight: 600;
            display: flex;
            align-items: center;
            gap: 10px;
            z-index: 10000;
            transform: translateX(400px);
            transition: transform 0.3s ease;
            box-shadow: 0 4px 15px rgba(0,0,0,0.2);
        }

        .notification.show {
            transform: translateX(0);
        }

        .notification-success {
            background: var(--success-color);
        }

        .notification-error {
            background: var(--danger-color);
        }

        .notification-info {
            background: var(--info-color);
        }

        .notification i {
            font-size: 1.1rem;
        }

        /* Audit Logs */
        .audit-controls {
            background: white;
            border-radius: var(--border-radius);
            padding: 25px;
            margin-bottom: 25px;
            box-shadow: var(--shadow);
        }

        .control-group {
            display: flex;
            gap: 20px;
            margin-bottom: 20px;
            flex-wrap: wrap;
        }

        .filter-group {
            flex: 1;
            min-width: 200px;
        }

        .filter-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: var(--dark-color);
        }

        .filter-group select {
            width: 100%;
            padding: 10px 12px;
            border: 2px solid #e9ecef;
            border-radius: 6px;
            font-size: 14px;
            transition: var(--transition);
        }

        .filter-group select:focus {
            outline: none;
            border-color: var(--primary-color);
            box-shadow: 0 0 0 3px rgba(220, 53, 69, 0.1);
        }

        .action-group {
            display: flex;
            gap: 15px;
            flex-wrap: wrap;
        }

        /* Log Statistics */
        .log-stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 25px;
        }

        .stat-item {
            background: white;
            border-radius: 12px;
            padding: 20px;
            display: flex;
            align-items: center;
            gap: 15px;
            box-shadow: var(--shadow);
            transition: var(--transition);
        }

        .stat-item:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(0,0,0,0.15);
        }

        .stat-icon {
            width: 50px;
            height: 50px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 1.3rem;
        }

        .stat-icon.info {
            background: var(--info-color);
        }

        .stat-icon.warning {
            background: var(--warning-color);
        }

        .stat-icon.error {
            background: var(--danger-color);
        }

        .stat-icon.critical {
            background: #8b0000;
        }

        .stat-content {
            flex: 1;
        }

        .stat-number {
            font-size: 1.8rem;
            font-weight: 700;
            color: var(--dark-color);
            line-height: 1;
        }

        .stat-label {
            color: #666;
            font-size: 0.9rem;
            margin-top: 5px;
        }

        /* Logs Section */
        .logs-section {
            background: white;
            border-radius: var(--border-radius);
            padding: 25px;
            margin-bottom: 25px;
            box-shadow: var(--shadow);
        }

        .logs-info {
            color: #666;
            font-size: 0.9rem;
        }

        .logs-table-container {
            overflow-x: auto;
            margin: 20px 0;
        }

        .logs-table {
            width: 100%;
            border-collapse: collapse;
            font-size: 14px;
        }

        .logs-table th {
            background: var(--light-color);
            padding: 15px 12px;
            text-align: left;
            font-weight: 600;
            color: var(--dark-color);
            border-bottom: 2px solid #e9ecef;
        }

        .logs-table td {
            padding: 12px;
            border-bottom: 1px solid #e9ecef;
            vertical-align: top;
        }

        .logs-table tr:hover {
            background: var(--light-color);
        }

        .logs-table .log-level {
            padding: 4px 8px;
            border-radius: 4px;
            font-size: 0.8rem;
            font-weight: 600;
            text-transform: uppercase;
        }

        .logs-table .log-level.info {
            background: rgba(13, 202, 240, 0.1);
            color: var(--info-color);
        }

        .logs-table .log-level.warning {
            background: rgba(255, 193, 7, 0.1);
            color: var(--warning-color);
        }

        .logs-table .log-level.error {
            background: rgba(220, 53, 69, 0.1);
            color: var(--danger-color);
        }

        .logs-table .log-level.critical {
            background: rgba(139, 0, 0, 0.1);
            color: #8b0000;
        }

        /* Pagination */
        .pagination {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 20px;
            margin-top: 20px;
        }

        .page-info {
            color: #666;
            font-weight: 600;
        }

        /* Real-time Monitor */
        .realtime-section {
            background: white;
            border-radius: var(--border-radius);
            padding: 25px;
            box-shadow: var(--shadow);
        }

        .monitor-controls {
            display: flex;
            gap: 15px;
        }

        .monitor-window {
            background: #1e1e1e;
            border-radius: 8px;
            margin-top: 20px;
            overflow: hidden;
            border: 1px solid #333;
        }

        .monitor-header {
            background: #2d2d2d;
            padding: 12px 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            border-bottom: 1px solid #333;
        }

        .monitor-status {
            color: #fff;
            font-weight: 600;
            font-size: 0.9rem;
        }

        .monitor-time {
            color: #ccc;
            font-family: monospace;
            font-size: 0.9rem;
        }

        .monitor-content {
            padding: 20px;
            min-height: 200px;
            max-height: 400px;
            overflow-y: auto;
            color: #fff;
            font-family: monospace;
            font-size: 0.9rem;
            line-height: 1.5;
        }

        .monitor-placeholder {
            text-align: center;
            color: #888;
            padding: 40px 20px;
        }

        .monitor-placeholder i {
            font-size: 3rem;
            margin-bottom: 15px;
            display: block;
        }

        .monitor-placeholder p {
            margin: 0;
            font-size: 1rem;
        }

        .log-entry {
            margin-bottom: 8px;
            padding: 8px 0;
            border-bottom: 1px solid #333;
        }

        .log-entry:last-child {
            border-bottom: none;
        }

        .log-timestamp {
            color: #888;
            margin-right: 10px;
        }

        .log-level-badge {
            display: inline-block;
            padding: 2px 6px;
            border-radius: 3px;
            font-size: 0.8rem;
            font-weight: 600;
            margin-right: 10px;
            text-transform: uppercase;
        }

        .log-level-badge.info {
            background: var(--info-color);
            color: white;
        }

        .log-level-badge.warning {
            background: var(--warning-color);
            color: white;
        }

        .log-level-badge.error {
            background: var(--danger-color);
            color: white;
        }

        .log-level-badge.critical {
            background: #8b0000;
            color: white;
        }

        .chart-card {
            background: white;
            border-radius: var(--border-radius);
            padding: 25px;
            box-shadow: var(--shadow);
        }

        .chart-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }

        .chart-title {
            font-size: 1.3rem;
            font-weight: 600;
            color: var(--dark-color);
        }

        .chart-container {
            position: relative;
            height: 300px;
        }

        /* Responsive Design */
        @media (max-width: 1200px) {
            .charts-section {
                grid-template-columns: 1fr;
            }
        }

        @media (max-width: 768px) {
            :root {
                --sidebar-width: 0px;
            }
            
            .sidebar {
                transform: translateX(-100%);
            }
            
            .sidebar.show {
                transform: translateX(0);
                width: 280px;
            }
            
            .main-content {
                margin-left: 0;
                padding: 20px;
            }
            
            .stats-grid {
                grid-template-columns: 1fr;
            }
            
            .header-title {
                font-size: 1.2rem;
            }
            
            .header-subtitle {
                display: none;
            }
            
            .mobile-menu-btn {
                display: block;
            }
        }

        @media (max-width: 480px) {
            .header {
                padding: 0 15px;
            }
            
            .header-left {
                flex-direction: column;
                align-items: flex-start;
                gap: 5px;
            }
            
            .header-right {
                flex-direction: column;
                gap: 10px;
            }
            
            .main-content {
                padding: 15px;
            }
            
            .stat-card {
                padding: 20px;
            }
        }
        
        .mobile-menu-btn {
            display: none;
            background: none;
            border: none;
            color: white;
            font-size: 1.5rem;
            cursor: pointer;
        }
        
        /* Loading States */
        .loading {
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 40px;
            color: #666;
        }
        
        .spinner {
            width: 20px;
            height: 20px;
            border: 2px solid #e9ecef;
            border-top: 2px solid var(--primary-color);
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin-right: 10px;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
    </style>
</head>
<body>
    <!-- Header -->
    <header class="header">
        <div class="header-left">
            <button class="mobile-menu-btn" onclick="toggleSidebar()">
                <i class="fas fa-bars"></i>
            </button>
            <div>
                <div class="header-title">👑 Super Admin Dashboard</div>
                <div class="header-subtitle">Enterprise Support System Control Panel</div>
            </div>
        </div>
        <div class="header-right">
            <div class="user-info">
                <div class="user-avatar">
                    <i class="fas fa-user"></i>
                </div>
                <div>
                    <div>Welcome, {{ current_user.username }}</div>
                    <div style="font-size: 0.8rem; opacity: 0.8;">Super Administrator</div>
                </div>
            </div>
            <a href="/admin/logout" class="logout-btn">
                <i class="fas fa-sign-out-alt"></i> Logout
            </a>
        </div>
    </header>
    
    <!-- Sidebar -->
    <nav class="sidebar" id="sidebar">
        <div class="sidebar-header">
            <div class="sidebar-title">Navigation Menu</div>
        </div>
        <div class="nav-menu">
            <div class="nav-item">
                <a href="#analytics" class="nav-link active" onclick="showTab('analytics')">
                    <i class="fas fa-chart-line"></i>
                    <span>Analytics Dashboard</span>
                </a>
            </div>
            <div class="nav-item">
                <a href="#users" class="nav-link" onclick="showTab('users')">
                    <i class="fas fa-users"></i>
                    <span>User Management</span>
                </a>
            </div>
            <div class="nav-item">
                <a href="#reports" class="nav-link" onclick="showTab('reports')">
                    <i class="fas fa-file-alt"></i>
                    <span>Performance Reports</span>
                </a>
            </div>
            <div class="nav-item">
                <a href="#settings" class="nav-link" onclick="showTab('settings')">
                    <i class="fas fa-cog"></i>
                    <span>System Settings</span>
                </a>
            </div>
            <div class="nav-item">
                <a href="#audit" class="nav-link" onclick="showTab('audit')">
                    <i class="fas fa-shield-alt"></i>
                    <span>Audit Logs</span>
                </a>
            </div>
        </div>
    </nav>
    
    <!-- Main Content -->
    <main class="main-content">
        <!-- Analytics Dashboard Tab -->
        <div id="analytics" class="tab-content active">
            <div class="page-header">
                <h1 class="page-title">Analytics Dashboard</h1>
                <p class="page-subtitle">Real-time system performance and key metrics</p>
            </div>
            
            <!-- Statistics Cards -->
            <div class="stats-grid">
                <div class="stat-card">
                    <div class="stat-header">
                        <div class="stat-icon primary">
                            <i class="fas fa-comments"></i>
                        </div>
                        <div class="stat-change positive">
                            <i class="fas fa-arrow-up"></i>
                            <span>+12%</span>
                        </div>
                    </div>
                    <div class="stat-number" id="totalMessages">-</div>
                    <div class="stat-label">Total Messages Today</div>
                </div>
                
                <div class="stat-card">
                    <div class="stat-header">
                        <div class="stat-icon success">
                            <i class="fas fa-users"></i>
                        </div>
                        <div class="stat-change positive">
                            <i class="fas fa-arrow-up"></i>
                            <span>+5%</span>
                        </div>
                    </div>
                    <div class="stat-number" id="activeUsers">-</div>
                    <div class="stat-label">Active Users</div>
                </div>
                
                <div class="stat-card">
                    <div class="stat-header">
                        <div class="stat-icon warning">
                            <i class="fas fa-exchange-alt"></i>
                        </div>
                        <div class="stat-change negative">
                            <i class="fas fa-arrow-down"></i>
                            <span>-3%</span>
                        </div>
                    </div>
                    <div class="stat-number" id="escalations">-</div>
                    <div class="stat-label">Escalations</div>
                </div>
                
                <div class="stat-card">
                    <div class="stat-header">
                        <div class="stat-icon info">
                            <i class="fas fa-heartbeat"></i>
                        </div>
                        <div class="stat-change positive">
                            <i class="fas fa-arrow-up"></i>
                            <span>+8%</span>
                        </div>
                    </div>
                    <div class="stat-number" id="systemHealth">-</div>
                    <div class="stat-label">System Health</div>
                </div>
            </div>
            
            <!-- Charts Section -->
            <div class="charts-section">
                <div class="chart-card">
                    <div class="chart-header">
                        <h3 class="chart-title">Message Activity (Last 7 Days)</h3>
                        <select id="chartPeriod" onchange="updateChart()">
                            <option value="7">7 Days</option>
                            <option value="30">30 Days</option>
                            <option value="90">90 Days</option>
                        </select>
                    </div>
                    <div class="chart-container">
                        <canvas id="messageChart"></canvas>
                    </div>
                </div>
                
                <div class="chart-card">
                    <div class="chart-header">
                        <h3 class="chart-title">Intent Distribution</h3>
                    </div>
                    <div class="chart-container">
                        <canvas id="intentChart"></canvas>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- User Management Tab -->
        <div id="users" class="tab-content">
            <div class="page-header">
                <h1 class="page-title">User Management</h1>
                <p class="page-subtitle">Manage agents and system users</p>
            </div>
            
            <!-- User Management Section -->
            <div class="user-management">
                <div class="section-header">
                    <h2 class="section-title">System Users</h2>
                    <button class="add-user-btn" onclick="toggleUserForm()">
                        <i class="fas fa-plus"></i> Add New User
                    </button>
                </div>
                
                <!-- Add User Form -->
                <div class="user-form" id="userForm">
                    <form id="addUserForm">
                        <div class="form-grid">
                            <div class="form-group">
                                <label for="username">Username</label>
                                <input type="text" id="username" name="username" required>
                            </div>
                            <div class="form-group">
                                <label for="email">Email</label>
                                <input type="email" id="email" name="email" required>
                            </div>
                        </div>
                        <div class="form-grid">
                            <div class="form-group">
                                <label for="password">Password</label>
                                <input type="password" id="password" name="password" required>
                            </div>
                            <div class="form-group">
                                <label for="role">Role</label>
                                <select id="role" name="role" required>
                                    <option value="">Select Role</option>
                                    <option value="agent">Agent</option>
                                    <option value="super_admin">Super Admin</option>
                                </select>
                            </div>
                        </div>
                        <div class="form-actions">
                            <button type="button" class="btn btn-secondary" onclick="toggleUserForm()">Cancel</button>
                            <button type="submit" class="btn btn-primary">Create User</button>
                        </div>
                    </form>
                </div>
                
                <!-- Users Table -->
                <div class="table-responsive">
                    <table class="users-table">
                        <thead>
                            <tr>
                                <th>Username</th>
                                <th>Email</th>
                                <th>Role</th>
                                <th>Status</th>
                                <th>Created</th>
                                <th>Last Login</th>
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody id="usersTableBody">
                            <tr>
                                <td colspan="7" class="loading">
                                    <div class="spinner"></div>
                                    Loading users...
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
        
        <!-- Performance Reports Tab -->
        <div id="reports" class="tab-content">
            <div class="page-header">
                <h1 class="page-title">Performance Reports</h1>
                <p class="page-subtitle">Detailed analytics and insights</p>
            </div>
            
            <!-- Performance Metrics Section -->
            <div class="performance-section">
                <div class="section-header">
                    <h2 class="section-title">Performance Metrics</h2>
                    <div class="report-controls">
                        <select id="reportPeriod" onchange="updatePerformanceReport()">
                            <option value="7">Last 7 Days</option>
                            <option value="30">Last 30 Days</option>
                            <option value="90">Last 90 Days</option>
                        </select>
                        <button class="btn btn-primary" onclick="exportReport()">
                            <i class="fas fa-download"></i> Export Report
                        </button>
                    </div>
                </div>
                
                <!-- Performance Cards -->
                <div class="performance-grid">
                    <div class="performance-card">
                        <div class="performance-icon">
                            <i class="fas fa-clock"></i>
                        </div>
                        <div class="performance-content">
                            <div class="performance-number" id="avgResponseTime">-</div>
                            <div class="performance-label">Avg Response Time</div>
                            <div class="performance-trend positive">+5.2% from last period</div>
                        </div>
                    </div>
                    
                    <div class="performance-card">
                        <div class="performance-icon">
                            <i class="fas fa-check-circle"></i>
                        </div>
                        <div class="performance-content">
                            <div class="performance-number" id="resolutionRate">-</div>
                            <div class="performance-label">Resolution Rate</div>
                            <div class="performance-trend positive">+2.1% from last period</div>
                        </div>
                    </div>
                    
                    <div class="performance-card">
                        <div class="performance-icon">
                            <i class="fas fa-smile"></i>
                        </div>
                        <div class="performance-content">
                            <div class="performance-number" id="satisfactionScore">-</div>
                            <div class="performance-label">Satisfaction Score</div>
                            <div class="performance-trend positive">+3.8% from last period</div>
                        </div>
                    </div>
                    
                    <div class="performance-card">
                        <div class="performance-icon">
                            <i class="fas fa-robot"></i>
                        </div>
                        <div class="performance-content">
                            <div class="performance-number" id="aiEfficiency">-</div>
                            <div class="performance-label">AI Efficiency</div>
                            <div class="performance-trend negative">-1.2% from last period</div>
                        </div>
                    </div>
                </div>
                
                <!-- Performance Charts -->
                <div class="performance-charts">
                    <div class="chart-card">
                        <div class="chart-header">
                            <h3 class="chart-title">Response Time Trends</h3>
                            <div class="chart-legend">
                                <span class="legend-item">
                                    <span class="legend-color ai"></span> AI Response
                                </span>
                                <span class="legend-item">
                                    <span class="legend-color human"></span> Human Response
                                </span>
                            </div>
                        </div>
                        <div class="chart-container">
                            <canvas id="responseTimeChart"></canvas>
                        </div>
                    </div>
                    
                    <div class="chart-card">
                        <div class="chart-header">
                            <h3 class="chart-title">Issue Resolution Timeline</h3>
                        </div>
                        <div class="chart-container">
                            <canvas id="resolutionChart"></canvas>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- System Settings Tab -->
        <div id="settings" class="tab-content">
            <div class="page-header">
                <h1 class="page-title">System Settings</h1>
                <p class="page-subtitle">Configure system parameters and behavior</p>
            </div>
            
            <!-- System Configuration Section -->
            <div class="settings-section">
                <div class="section-header">
                    <h2 class="section-title">System Configuration</h2>
                    <button class="btn btn-primary" onclick="saveAllSettings()">
                        <i class="fas fa-save"></i> Save All Changes
                    </button>
                </div>
                
                <!-- Settings Grid -->
                <div class="settings-grid">
                    <!-- AI Configuration -->
                    <div class="settings-card">
                        <div class="settings-card-header">
                            <h3><i class="fas fa-robot"></i> AI Configuration</h3>
                        </div>
                        <div class="settings-form">
                            <div class="form-group">
                                <label for="openaiApiKey">OpenAI API Key</label>
                                <input type="password" id="openaiApiKey" placeholder="sk-..." value="••••••••••••••••">
                                <small>Your OpenAI API key for AI-powered responses</small>
                            </div>
                            <div class="form-group">
                                <label for="aiModel">AI Model</label>
                                <select id="aiModel">
                                    <option value="gpt-3.5-turbo">GPT-3.5 Turbo</option>
                                    <option value="gpt-4">GPT-4</option>
                                    <option value="gpt-4-turbo">GPT-4 Turbo</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label for="maxTokens">Max Tokens</label>
                                <input type="number" id="maxTokens" value="150" min="50" max="1000">
                                <small>Maximum tokens for AI responses</small>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Chat Configuration -->
                    <div class="settings-card">
                        <div class="settings-card-header">
                            <h3><i class="fas fa-comments"></i> Chat Configuration</h3>
                        </div>
                        <div class="settings-form">
                            <div class="form-group">
                                <label for="escalationThreshold">Escalation Threshold</label>
                                <input type="number" id="escalationThreshold" value="0.7" min="0.1" max="1.0" step="0.1">
                                <small>AI confidence threshold for human escalation (0.1 - 1.0)</small>
                            </div>
                            <div class="form-group">
                                <label for="sessionTimeout">Session Timeout (minutes)</label>
                                <input type="number" id="sessionTimeout" value="30" min="5" max="120">
                                <small>Inactive session timeout period</small>
                            </div>
                            <div class="form-group">
                                <label for="maxMessages">Max Messages per Session</label>
                                <input type="number" id="maxMessages" value="50" min="10" max="200">
                                <small>Maximum messages allowed per chat session</small>
                            </div>
                        </div>
                    </div>
                    
                    <!-- System Preferences -->
                    <div class="settings-card">
                        <div class="settings-card-header">
                            <h3><i class="fas fa-cog"></i> System Preferences</h3>
                        </div>
                        <div class="settings-form">
                            <div class="form-group">
                                <label for="timezone">System Timezone</label>
                                <select id="timezone">
                                    <option value="UTC">UTC</option>
                                    <option value="America/New_York">Eastern Time</option>
                                    <option value="America/Chicago">Central Time</option>
                                    <option value="America/Denver">Mountain Time</option>
                                    <option value="America/Los_Angeles">Pacific Time</option>
                                    <option value="Europe/London">London</option>
                                    <option value="Asia/Tokyo">Tokyo</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label for="language">Default Language</label>
                                <select id="language">
                                    <option value="en">English</option>
                                    <option value="es">Spanish</option>
                                    <option value="fr">French</option>
                                    <option value="de">German</option>
                                    <option value="ja">Japanese</option>
                                    <option value="zh">Chinese</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label for="maintenanceMode">Maintenance Mode</label>
                                <div class="toggle-switch">
                                    <input type="checkbox" id="maintenanceMode">
                                    <label for="maintenanceMode"></label>
                                </div>
                                <small>Enable maintenance mode to restrict access</small>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Security Settings -->
                    <div class="settings-card">
                        <div class="settings-card-header">
                            <h3><i class="fas fa-shield-alt"></i> Security Settings</h3>
                        </div>
                        <div class="settings-form">
                            <div class="form-group">
                                <label for="passwordPolicy">Password Policy</label>
                                <select id="passwordPolicy">
                                    <option value="low">Low (6+ characters)</option>
                                    <option value="medium">Medium (8+ characters, mixed case)</option>
                                    <option value="high">High (10+ characters, symbols, numbers)</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label for="sessionDuration">Session Duration (hours)</label>
                                <input type="number" id="sessionDuration" value="8" min="1" max="24">
                                <small>How long user sessions remain active</small>
                            </div>
                            <div class="form-group">
                                <label for="twoFactorAuth">Two-Factor Authentication</label>
                                <div class="toggle-switch">
                                    <input type="checkbox" id="twoFactorAuth">
                                    <label for="twoFactorAuth"></label>
                                </div>
                                <small>Require 2FA for all admin accounts</small>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- System Status -->
                <div class="system-status-section">
                    <div class="section-header">
                        <h2 class="section-title">System Status</h2>
                        <button class="btn btn-secondary" onclick="refreshSystemStatus()">
                            <i class="fas fa-sync"></i> Refresh
                        </button>
                    </div>
                    
                    <div class="status-grid">
                        <div class="status-item">
                            <div class="status-icon online">
                                <i class="fas fa-database"></i>
                            </div>
                            <div class="status-info">
                                <div class="status-label">Database</div>
                                <div class="status-value">Connected</div>
                            </div>
                        </div>
                        
                        <div class="status-item">
                            <div class="status-icon online">
                                <i class="fas fa-robot"></i>
                            </div>
                            <div class="status-info">
                                <div class="status-label">OpenAI API</div>
                                <div class="status-value">Active</div>
                            </div>
                        </div>
                        
                        <div class="status-item">
                            <div class="status-icon online">
                                <i class="fas fa-wifi"></i>
                            </div>
                            <div class="status-info">
                                <div class="status-label">WebSocket</div>
                                <div class="status-value">Connected</div>
                            </div>
                        </div>
                        
                        <div class="status-item">
                            <div class="status-icon online">
                                <i class="fas fa-server"></i>
                            </div>
                            <div class="status-info">
                                <div class="status-label">System</div>
                                <div class="status-value">Healthy</div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Audit Logs Tab -->
        <div id="audit" class="tab-content">
            <div class="page-header">
                <h1 class="page-title">Audit Logs</h1>
                <p class="page-subtitle">Track all system activities and changes</p>
            </div>
            
            <!-- Audit Controls Section -->
            <div class="audit-controls">
                <div class="control-group">
                    <div class="filter-group">
                        <label for="logLevel">Log Level</label>
                        <select id="logLevel" onchange="filterLogs()">
                            <option value="all">All Levels</option>
                            <option value="info">Info</option>
                            <option value="warning">Warning</option>
                            <option value="error">Error</option>
                            <option value="critical">Critical</option>
                        </select>
                    </div>
                    
                    <div class="filter-group">
                        <label for="logCategory">Category</label>
                        <select id="logCategory" onchange="filterLogs()">
                            <option value="all">All Categories</option>
                            <option value="user">User Management</option>
                            <option value="chat">Chat System</option>
                            <option value="system">System Operations</option>
                            <option value="security">Security Events</option>
                            <option value="ai">AI Operations</option>
                        </select>
                    </div>
                    
                    <div class="filter-group">
                        <label for="dateRange">Date Range</label>
                        <select id="dateRange" onchange="filterLogs()">
                            <option value="today">Today</option>
                            <option value="yesterday">Yesterday</option>
                            <option value="week">Last 7 Days</option>
                            <option value="month">Last 30 Days</option>
                            <option value="custom">Custom Range</option>
                        </select>
                    </div>
                </div>
                
                <div class="action-group">
                    <button class="btn btn-secondary" onclick="refreshLogs()">
                        <i class="fas fa-sync"></i> Refresh
                    </button>
                    <button class="btn btn-primary" onclick="exportLogs()">
                        <i class="fas fa-download"></i> Export Logs
                    </button>
                    <button class="btn btn-danger" onclick="clearLogs()">
                        <i class="fas fa-trash"></i> Clear Old Logs
                    </button>
                </div>
            </div>
            
            <!-- Log Statistics -->
            <div class="log-stats">
                <div class="stat-item">
                    <div class="stat-icon info">
                        <i class="fas fa-info-circle"></i>
                    </div>
                    <div class="stat-content">
                        <div class="stat-number" id="infoCount">0</div>
                        <div class="stat-label">Info Logs</div>
                    </div>
                </div>
                
                <div class="stat-item">
                    <div class="stat-icon warning">
                        <i class="fas fa-exclamation-triangle"></i>
                    </div>
                    <div class="stat-content">
                        <div class="stat-number" id="warningCount">0</div>
                        <div class="stat-label">Warnings</div>
                    </div>
                </div>
                
                <div class="stat-item">
                    <div class="stat-icon error">
                        <i class="fas fa-times-circle"></i>
                    </div>
                    <div class="stat-content">
                        <div class="stat-number" id="errorCount">0</div>
                        <div class="stat-label">Errors</div>
                    </div>
                </div>
                
                <div class="stat-item">
                    <div class="stat-icon critical">
                        <i class="fas fa-radiation"></i>
                    </div>
                    <div class="stat-content">
                        <div class="stat-number" id="criticalCount">0</div>
                        <div class="stat-label">Critical</div>
                    </div>
                </div>
            </div>
            
            <!-- Logs Table -->
            <div class="logs-section">
                <div class="section-header">
                    <h2 class="section-title">System Logs</h2>
                    <div class="logs-info">
                        <span id="totalLogs">0</span> total logs
                    </div>
                </div>
                
                <div class="logs-table-container">
                    <table class="logs-table">
                        <thead>
                            <tr>
                                <th>Timestamp</th>
                                <th>Level</th>
                                <th>Category</th>
                                <th>User</th>
                                <th>Action</th>
                                <th>Details</th>
                                <th>IP Address</th>
                            </tr>
                        </thead>
                        <tbody id="logsTableBody">
                            <!-- Logs will be populated here -->
                        </tbody>
                    </table>
                </div>
                
                <!-- Pagination -->
                <div class="pagination">
                    <button class="btn btn-secondary" onclick="previousPage()" id="prevBtn">
                        <i class="fas fa-chevron-left"></i> Previous
                    </button>
                    <div class="page-info">
                        Page <span id="currentPage">1</span> of <span id="totalPages">1</span>
                    </div>
                    <button class="btn btn-secondary" onclick="nextPage()" id="nextBtn">
                        Next <i class="fas fa-chevron-right"></i>
                    </button>
                </div>
            </div>
            
            <!-- Real-time Log Monitor -->
            <div class="realtime-section">
                <div class="section-header">
                    <h2 class="section-title">Real-time Monitor</h2>
                    <div class="monitor-controls">
                        <button class="btn btn-success" onclick="startMonitoring()" id="startBtn">
                            <i class="fas fa-play"></i> Start Monitoring
                        </button>
                        <button class="btn btn-danger" onclick="stopMonitoring()" id="stopBtn" style="display: none;">
                            <i class="fas fa-stop"></i> Stop Monitoring
                        </button>
                    </div>
                </div>
                
                <div class="monitor-window" id="monitorWindow">
                    <div class="monitor-header">
                        <span class="monitor-status" id="monitorStatus">Stopped</span>
                        <span class="monitor-time" id="monitorTime">--:--:--</span>
                    </div>
                    <div class="monitor-content" id="monitorContent">
                        <div class="monitor-placeholder">
                            <i class="fas fa-terminal"></i>
                            <p>Click "Start Monitoring" to begin real-time log monitoring</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </main>
    
    <script>
        // Global variables
        let currentTab = 'analytics';
        let messageChart = null;
        let intentChart = null;
        let responseTimeChart = null;
        let resolutionChart = null;
        
        // Tab management
        function showTab(tabName) {
            // Hide all tabs
            document.querySelectorAll('.tab-content').forEach(tab => {
                tab.classList.remove('active');
            });
            
            // Remove active class from all nav links
            document.querySelectorAll('.nav-link').forEach(link => {
                link.classList.remove('active');
            });
            
            // Show selected tab
            document.getElementById(tabName).classList.add('active');
            
            // Add active class to clicked nav link
            event.target.classList.add('active');
            
            currentTab = tabName;
            
            // Load tab-specific data
            loadTabData(tabName);
        }
        
        // Load data for specific tabs
        function loadTabData(tabName) {
            switch(tabName) {
                case 'analytics':
                    loadAnalyticsData();
                    break;
                case 'users':
                    loadUsers();
                    break;
                case 'reports':
                    loadPerformanceData();
                    break;
                case 'settings':
                    loadSettings();
                    break;
                case 'audit':
                    loadAuditLogs();
                    break;
            }
        }
        
        // Toggle sidebar on mobile
        function toggleSidebar() {
            const sidebar = document.getElementById('sidebar');
            sidebar.classList.toggle('show');
        }
        
        // Load analytics data
        async function loadAnalyticsData() {
            try {
                const response = await fetch('/api/analytics');
                const data = await response.json();
                
                // Update stats
                document.getElementById('totalMessages').textContent = data.total_messages || 0;
                document.getElementById('escalations').textContent = data.escalated_count || 0;
                
                // Calculate system health
                const aiSuccessRate = data.avg_confidence || 0;
                const healthScore = Math.round(aiSuccessRate * 100);
                document.getElementById('systemHealth').textContent = healthScore + '%';
                
                // Estimate active users
                const activeUsers = Math.min(data.total_messages || 0, 50);
                document.getElementById('activeUsers').textContent = activeUsers;
                
                // Initialize charts
                initializeCharts(data);
                
            } catch (error) {
                console.error('Failed to load analytics data:', error);
            }
        }
        
        // Initialize charts
        function initializeCharts(data) {
            // Message Activity Chart
            const messageCtx = document.getElementById('messageChart').getContext('2d');
            messageChart = new Chart(messageCtx, {
                type: 'line',
                data: {
                    labels: ['Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat', 'Sun'],
                    datasets: [{
                        label: 'Messages',
                        data: [65, 59, 80, 81, 56, 55, 40],
                        borderColor: '#dc3545',
                        backgroundColor: 'rgba(220, 53, 69, 0.1)',
                        tension: 0.4
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            position: 'top',
                        }
                    }
                }
            });
            
            // Intent Distribution Chart
            const intentCtx = document.getElementById('intentChart').getContext('2d');
            intentChart = new Chart(intentCtx, {
                type: 'doughnut',
                data: {
                    labels: ['Greeting', 'Support', 'Billing', 'Technical', 'Other'],
                    datasets: [{
                        data: [30, 25, 20, 15, 10],
                        backgroundColor: [
                            '#dc3545',
                            '#28a745',
                            '#ffc107',
                            '#17a2b8',
                            '#6c757d'
                        ]
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            position: 'bottom',
                        }
                    }
                }
            });
        }
        
        // Update chart period
        function updateChart() {
            // Will implement chart period updates
            console.log('Chart period updated');
        }

        // Performance Reports Functions
        function updatePerformanceReport() {
            const period = document.getElementById('reportPeriod').value;
            loadPerformanceData(period);
        }

        async function loadPerformanceData(period = 7) {
            try {
                // Simulate loading performance data
                const mockData = generateMockPerformanceData(period);
                
                // Update performance cards
                document.getElementById('avgResponseTime').textContent = mockData.avgResponseTime;
                document.getElementById('resolutionRate').textContent = mockData.resolutionRate;
                document.getElementById('satisfactionScore').textContent = mockData.satisfactionScore;
                document.getElementById('aiEfficiency').textContent = mockData.aiEfficiency;
                
                // Initialize performance charts
                initializePerformanceCharts(mockData);
                
            } catch (error) {
                console.error('Failed to load performance data:', error);
            }
        }

        function generateMockPerformanceData(period) {
            // Generate realistic mock data based on period
            const baseData = {
                7: { avgResponseTime: '2.3s', resolutionRate: '94.2%', satisfactionScore: '8.7/10', aiEfficiency: '87.5%' },
                30: { avgResponseTime: '2.1s', resolutionRate: '95.8%', satisfactionScore: '8.9/10', aiEfficiency: '89.2%' },
                90: { avgResponseTime: '1.9s', resolutionRate: '96.3%', satisfactionScore: '9.1/10', aiEfficiency: '91.7%' }
            };
            
            return baseData[period] || baseData[7];
        }

        function initializePerformanceCharts(data) {
            // Response Time Trends Chart
            const responseCtx = document.getElementById('responseTimeChart').getContext('2d');
            if (responseTimeChart) {
                responseTimeChart.destroy();
            }
            
            responseTimeChart = new Chart(responseCtx, {
                type: 'line',
                data: {
                    labels: ['Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat', 'Sun'],
                    datasets: [{
                        label: 'AI Response Time',
                        data: [2.1, 1.8, 2.3, 1.9, 2.0, 1.7, 1.5],
                        borderColor: '#dc3545',
                        backgroundColor: 'rgba(220, 53, 69, 0.1)',
                        tension: 0.4
                    }, {
                        label: 'Human Response Time',
                        data: [5.2, 4.8, 6.1, 5.5, 4.9, 5.8, 5.3],
                        borderColor: '#28a745',
                        backgroundColor: 'rgba(40, 167, 69, 0.1)',
                        tension: 0.4
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            position: 'top',
                        }
                    },
                    scales: {
                        y: {
                            beginAtZero: true,
                            title: {
                                display: true,
                                text: 'Response Time (seconds)'
                            }
                        }
                    }
                }
            });
            
            // Resolution Timeline Chart
            const resolutionCtx = document.getElementById('resolutionChart').getContext('2d');
            if (resolutionChart) {
                resolutionChart.destroy();
            }
            
            resolutionChart = new Chart(resolutionCtx, {
                type: 'bar',
                data: {
                    labels: ['0-1h', '1-4h', '4-8h', '8-24h', '24h+'],
                    datasets: [{
                        label: 'Issues Resolved',
                        data: [45, 78, 32, 15, 8],
                        backgroundColor: '#17a2b8'
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            position: 'top',
                        }
                    },
                    scales: {
                        y: {
                            beginAtZero: true,
                            title: {
                                display: true,
                                text: 'Number of Issues'
                            }
                        }
                    }
                }
            });
        }

        function exportReport() {
            // Implement report export functionality
            alert('Report export functionality will be implemented here. This would generate a PDF or Excel report.');
        }

        // System Settings Functions
        function saveAllSettings() {
            // Collect all settings values
            const settings = {
                openaiApiKey: document.getElementById('openaiApiKey').value,
                aiModel: document.getElementById('aiModel').value,
                maxTokens: document.getElementById('maxTokens').value,
                escalationThreshold: document.getElementById('escalationThreshold').value,
                sessionTimeout: document.getElementById('sessionTimeout').value,
                maxMessages: document.getElementById('maxMessages').value,
                timezone: document.getElementById('timezone').value,
                language: document.getElementById('language').value,
                maintenanceMode: document.getElementById('maintenanceMode').checked,
                passwordPolicy: document.getElementById('passwordPolicy').value,
                sessionDuration: document.getElementById('sessionDuration').value,
                twoFactorAuth: document.getElementById('twoFactorAuth').checked
            };
            
            // Save settings (in real app, this would send to backend)
            localStorage.setItem('systemSettings', JSON.stringify(settings));
            
            // Show success message
            showNotification('Settings saved successfully!', 'success');
        }

        function loadSettings() {
            // Load saved settings from localStorage
            const savedSettings = localStorage.getItem('systemSettings');
            if (savedSettings) {
                const settings = JSON.parse(savedSettings);
                
                // Apply settings to form fields
                Object.keys(settings).forEach(key => {
                    const element = document.getElementById(key);
                    if (element) {
                        if (element.type === 'checkbox') {
                            element.checked = settings[key];
                        } else {
                            element.value = settings[key];
                        }
                    }
                });
            }
        }

        function refreshSystemStatus() {
            // Simulate refreshing system status
            const statusItems = document.querySelectorAll('.status-item');
            
            statusItems.forEach(item => {
                const icon = item.querySelector('.status-icon');
                const value = item.querySelector('.status-value');
                
                // Simulate status check
                setTimeout(() => {
                    icon.className = 'status-icon online';
                    value.textContent = 'Connected';
                }, Math.random() * 1000);
            });
            
            showNotification('System status refreshed!', 'info');
        }

        function showNotification(message, type = 'info') {
            // Create notification element
            const notification = document.createElement('div');
            notification.className = `notification notification-${type}`;
            notification.innerHTML = `
                <i class="fas fa-${type === 'success' ? 'check-circle' : type === 'error' ? 'exclamation-circle' : 'info-circle'}"></i>
                <span>${message}</span>
            `;
            
            // Add to page
            document.body.appendChild(notification);
            
            // Show notification
            setTimeout(() => notification.classList.add('show'), 100);
            
            // Remove after 3 seconds
            setTimeout(() => {
                notification.classList.remove('show');
                setTimeout(() => notification.remove(), 300);
            }, 3000);
        }

        // Audit Logs Functions
        let currentPage = 1;
        let logsPerPage = 20;
        let allLogs = [];
        let filteredLogs = [];
        let monitoringInterval = null;

        function loadAuditLogs() {
            // Generate mock audit logs
            generateMockLogs();
            
            // Apply filters and display
            filterLogs();
            
            // Update statistics
            updateLogStats();
        }

        function generateMockLogs() {
            const logLevels = ['info', 'warning', 'error', 'critical'];
            const categories = ['user', 'chat', 'system', 'security', 'ai'];
            const actions = [
                'User Login', 'User Logout', 'Chat Message', 'AI Response', 
                'System Restart', 'Database Backup', 'Security Alert', 'API Call',
                'File Upload', 'Configuration Change', 'Error Occurred', 'Warning Triggered'
            ];
            const users = ['superadmin', 'agent1', 'agent2', 'system', 'anonymous'];
            const ips = ['192.168.1.100', '10.0.0.50', '172.16.0.25', '127.0.0.1'];

            allLogs = [];
            
            for (let i = 0; i < 150; i++) {
                const timestamp = new Date(Date.now() - Math.random() * 30 * 24 * 60 * 60 * 1000);
                const level = logLevels[Math.floor(Math.random() * logLevels.length)];
                const category = categories[Math.floor(Math.random() * categories.length)];
                const action = actions[Math.floor(Math.random() * actions.length)];
                const user = users[Math.floor(Math.random() * users.length)];
                const ip = ips[Math.floor(Math.random() * ips.length)];
                
                allLogs.push({
                    id: i + 1,
                    timestamp: timestamp,
                    level: level,
                    category: category,
                    user: user,
                    action: action,
                    details: `Detailed information about ${action.toLowerCase()} performed by ${user}`,
                    ip: ip
                });
            }
            
            // Sort by timestamp (newest first)
            allLogs.sort((a, b) => b.timestamp - a.timestamp);
        }

        function filterLogs() {
            const levelFilter = document.getElementById('logLevel').value;
            const categoryFilter = document.getElementById('logCategory').value;
            const dateFilter = document.getElementById('dateRange').value;
            
            filteredLogs = allLogs.filter(log => {
                // Level filter
                if (levelFilter !== 'all' && log.level !== levelFilter) return false;
                
                // Category filter
                if (categoryFilter !== 'all' && log.category !== categoryFilter) return false;
                
                // Date filter
                const now = new Date();
                const logDate = new Date(log.timestamp);
                
                switch (dateFilter) {
                    case 'today':
                        if (logDate.toDateString() !== now.toDateString()) return false;
                        break;
                    case 'yesterday':
                        const yesterday = new Date(now);
                        yesterday.setDate(yesterday.getDate() - 1);
                        if (logDate.toDateString() !== yesterday.toDateString()) return false;
                        break;
                    case 'week':
                        const weekAgo = new Date(now);
                        weekAgo.setDate(weekAgo.getDate() - 7);
                        if (logDate < weekAgo) return false;
                        break;
                    case 'month':
                        const monthAgo = new Date(now);
                        monthAgo.setMonth(monthAgo.getMonth() - 1);
                        if (logDate < monthAgo) return false;
                        break;
                }
                
                return true;
            });
            
            currentPage = 1;
            displayLogs();
            updateLogStats();
        }

        function displayLogs() {
            const tbody = document.getElementById('logsTableBody');
            const startIndex = (currentPage - 1) * logsPerPage;
            const endIndex = startIndex + logsPerPage;
            const pageLogs = filteredLogs.slice(startIndex, endIndex);
            
            tbody.innerHTML = '';
            
            pageLogs.forEach(log => {
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td>${formatTimestamp(log.timestamp)}</td>
                    <td><span class="log-level ${log.level}">${log.level}</span></td>
                    <td>${log.category}</td>
                    <td>${log.user}</td>
                    <td>${log.action}</td>
                    <td>${log.details}</td>
                    <td>${log.ip}</td>
                `;
                tbody.appendChild(row);
            });
            
            updatePagination();
        }

        function formatTimestamp(timestamp) {
            return timestamp.toLocaleString();
        }

        function updatePagination() {
            const totalPages = Math.ceil(filteredLogs.length / logsPerPage);
            document.getElementById('currentPage').textContent = currentPage;
            document.getElementById('totalPages').textContent = totalPages;
            document.getElementById('totalLogs').textContent = filteredLogs.length;
            
            // Update button states
            document.getElementById('prevBtn').disabled = currentPage === 1;
            document.getElementById('nextBtn').disabled = currentPage === totalPages;
        }

        function previousPage() {
            if (currentPage > 1) {
                currentPage--;
                displayLogs();
            }
        }

        function nextPage() {
            const totalPages = Math.ceil(filteredLogs.length / logsPerPage);
            if (currentPage < totalPages) {
                currentPage++;
                displayLogs();
            }
        }

        function updateLogStats() {
            const stats = {
                info: 0,
                warning: 0,
                error: 0,
                critical: 0
            };
            
            filteredLogs.forEach(log => {
                stats[log.level]++;
            });
            
            document.getElementById('infoCount').textContent = stats.info;
            document.getElementById('warningCount').textContent = stats.warning;
            document.getElementById('errorCount').textContent = stats.error;
            document.getElementById('criticalCount').textContent = stats.critical;
        }

        function refreshLogs() {
            loadAuditLogs();
            showNotification('Logs refreshed successfully!', 'success');
        }

        function exportLogs() {
            // Create CSV content
            let csv = 'Timestamp,Level,Category,User,Action,Details,IP Address\n';
            
            filteredLogs.forEach(log => {
                csv += `"${formatTimestamp(log.timestamp)}","${log.level}","${log.category}","${log.user}","${log.action}","${log.details}","${log.ip}"\n`;
            });
            
            // Download file
            const blob = new Blob([csv], { type: 'text/csv' });
            const url = window.URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `audit_logs_${new Date().toISOString().split('T')[0]}.csv`;
            a.click();
            window.URL.revokeObjectURL(url);
            
            showNotification('Logs exported successfully!', 'success');
        }

        function clearLogs() {
            if (confirm('Are you sure you want to clear old logs? This action cannot be undone.')) {
                // In a real app, this would send a request to the backend
                allLogs = allLogs.filter(log => {
                    const logDate = new Date(log.timestamp);
                    const weekAgo = new Date();
                    weekAgo.setDate(weekAgo.getDate() - 7);
                    return logDate > weekAgo;
                });
                
                filterLogs();
                showNotification('Old logs cleared successfully!', 'success');
            }
        }

        // Real-time Monitoring Functions
        function startMonitoring() {
            document.getElementById('startBtn').style.display = 'none';
            document.getElementById('stopBtn').style.display = 'inline-block';
            document.getElementById('monitorStatus').textContent = 'Monitoring';
            document.getElementById('monitorStatus').style.color = '#28a745';
            
            // Clear placeholder
            document.getElementById('monitorContent').innerHTML = '';
            
            // Start monitoring interval
            monitoringInterval = setInterval(() => {
                addLogEntry();
                updateMonitorTime();
            }, 2000);
            
            showNotification('Real-time monitoring started!', 'success');
        }

        function stopMonitoring() {
            document.getElementById('startBtn').style.display = 'inline-block';
            document.getElementById('stopBtn').style.display = 'none';
            document.getElementById('monitorStatus').textContent = 'Stopped';
            document.getElementById('monitorStatus').style.color = '#dc3545';
            
            // Clear interval
            if (monitoringInterval) {
                clearInterval(monitoringInterval);
                monitoringInterval = null;
            }
            
            showNotification('Real-time monitoring stopped!', 'info');
        }

        function addLogEntry() {
            const monitorContent = document.getElementById('monitorContent');
            const logLevels = ['info', 'warning', 'error'];
            const categories = ['system', 'chat', 'user', 'ai'];
            const actions = ['Heartbeat', 'Connection Check', 'Status Update', 'Data Sync'];
            
            const level = logLevels[Math.floor(Math.random() * logLevels.length)];
            const category = categories[Math.floor(Math.random() * categories.length)];
            const action = actions[Math.floor(Math.random() * actions.length)];
            const timestamp = new Date().toLocaleTimeString();
            
            const logEntry = document.createElement('div');
            logEntry.className = 'log-entry';
            logEntry.innerHTML = `
                <span class="log-timestamp">[${timestamp}]</span>
                <span class="log-level-badge ${level}">${level}</span>
                <span>[${category}]</span>
                <span>${action}</span>
            `;
            
            monitorContent.appendChild(logEntry);
            
            // Auto-scroll to bottom
            monitorContent.scrollTop = monitorContent.scrollHeight;
            
            // Keep only last 50 entries
            const entries = monitorContent.querySelectorAll('.log-entry');
            if (entries.length > 50) {
                entries[0].remove();
            }
        }

        function updateMonitorTime() {
            const now = new Date();
            const timeString = now.toLocaleTimeString();
            document.getElementById('monitorTime').textContent = timeString;
        }
        
        // User Management Functions
        function toggleUserForm() {
            const form = document.getElementById('userForm');
            form.classList.toggle('show');
        }
        
        // Load users
        async function loadUsers() {
            try {
                const response = await fetch('/api/admin/users');
                const data = await response.json();
                
                const tbody = document.getElementById('usersTableBody');
                tbody.innerHTML = '';
                
                if (data.users && data.users.length > 0) {
                    data.users.forEach(user => {
                        const row = document.createElement('tr');
                        row.innerHTML = `
                            <td>${user.username}</td>
                            <td>${user.email}</td>
                            <td><span class="role-badge role-${user.role}">${user.role}</span></td>
                            <td><span class="status-badge status-${user.is_active ? 'active' : 'inactive'}">${user.is_active ? 'Active' : 'Inactive'}</span></td>
                            <td>${new Date(user.created_at).toLocaleDateString()}</td>
                            <td>${user.last_login ? new Date(user.last_login).toLocaleDateString() : 'Never'}</td>
                            <td>
                                <button class="btn btn-danger" onclick="deleteUser('${user.id}')">
                                    <i class="fas fa-trash"></i>
                                </button>
                            </td>
                        `;
                        tbody.appendChild(row);
                    });
                } else {
                    tbody.innerHTML = '<tr><td colspan="7" style="text-align: center; padding: 40px; color: #666;">No users found</td></tr>';
                }
                
            } catch (error) {
                console.error('Failed to load users:', error);
                document.getElementById('usersTableBody').innerHTML = '<tr><td colspan="7" style="text-align: center; padding: 40px; color: #dc3545;">Failed to load users</td></tr>';
            }
        }
        
        // Add user form submission
        document.getElementById('addUserForm').addEventListener('submit', async function(e) {
            e.preventDefault();
            
            const formData = new FormData(this);
            const userData = {
                username: formData.get('username'),
                email: formData.get('email'),
                password: formData.get('password'),
                role: formData.get('role')
            };
            
            try {
                const response = await fetch('/api/admin/users', {
                    method: 'POST',
                    headers: {'Content-Type': 'application/json'},
                    body: JSON.stringify(userData)
                });
                
                const result = await response.json();
                
                if (result.success) {
                    alert('User created successfully!');
                    this.reset();
                    toggleUserForm();
                    loadUsers();
                } else {
                    alert('Error: ' + result.error);
                }
            } catch (error) {
                console.error('Failed to create user:', error);
                alert('Failed to create user. Please try again.');
            }
        });
        
        // Delete user
        function deleteUser(userId) {
            if (confirm('Are you sure you want to delete this user?')) {
                // Implement user deletion
                alert('User deletion functionality will be implemented here.');
            }
        }
        
        // Initialize dashboard
        document.addEventListener('DOMContentLoaded', function() {
            loadAnalyticsData();
            
            // Refresh data every 30 seconds
            setInterval(() => {
                if (currentTab === 'analytics') {
                    loadAnalyticsData();
                }
            }, 30000);
        });
        
        // Handle window resize
        window.addEventListener('resize', function() {
            if (window.innerWidth > 768) {
                document.getElementById('sidebar').classList.remove('show');
            }
        });
    </script>
</body>
</html>
